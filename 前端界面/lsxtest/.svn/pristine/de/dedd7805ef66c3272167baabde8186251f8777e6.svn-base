<?php
/**
 * Created by PhpStorm.
 * User: Administrator
 * Date: 2017/9/12
 * Time: 9:27
 */
namespace app\modules\count\controllers;

use app\modules\count\models\CountDo;
use app\modules\index\filters\PermissionFilter;
use common\models\Admin;
use common\models\ShopAccount;
use yii\web\Controller;

class CountController extends Controller{

    public $layout = false;

    public function __construct ($id, $module, $config = [])
    {
        $module = \Yii::$app->getModule('count');
        parent::__construct($id, $module, $config);
    }
    public function behaviors()
    {
        return [
            [
                'class' => PermissionFilter::className()
            ]
        ]; // TODO: Change the autogenerated stub
    }

    public function actionCount (){


      $data=[];
      $arr=[];
      $list=['begin_time'=>'','end_time'=>'','is'=>''];
        $cookie = \Yii::$app->request->cookies;
        $cook['admin_name']=$cookie->getValue('admin_name');
        $cook['ip']=$cookie->getValue('ip');
        $cook['last_time']=$cookie->getValue('last_time');
        $arr=CountDo::PageCount();
//      var_dump($arr);die();
//
        if(posts())
        {
            $list=posts();
            $list['is']=1;
            $data=CountDo::PageList();
        }

        return $this->render('list.tpl',['arr'=>$arr,'data'=>$data,'list'=>$list,'cook'=>$cook]);

    }

};