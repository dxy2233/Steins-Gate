<?php
/**
 * Created by PhpStorm.
 * User: Administrator
 * Date: 2017/9/12
 * Time: 9:27
 */
namespace app\modules\banquet\controllers;

use app\modules\banquet\models\BanqueDo;
use yii\web\Controller;

class BanquetController extends Controller{

    public $layout = false;

    public function __construct ($id, $module, $config = [])
    {
        $module = \Yii::$app->getModule('banquet');
        parent::__construct($id, $module, $config);
    }

    public function actionList (){
        $post=[
            'banquet_sn'=>'',
            'banquet_time_start'=>'',
            'banquet_time_end'=>'',
            'shop_name'=>'',
            'record_sn'=>'',
            'create_time_start'=>'',
            'create_time_end'=>'',
            'order_status'=>''
            ];
        if(posts())
        {

            $post=posts();
            $fileter=BanqueDo::BanquetList($post);
            $post=$fileter['post'];
//           var_dump($fileter);die();
        }
        elseif(gets())
        {
            $post=gets('post');
            $fileter=BanqueDo::BanquetList($post);
            $post=$fileter['post'];
        }
        else
        {
            $fileter=BanqueDo::BanquetList();
        }

        $page=$fileter['page'];
        $data=$fileter['data'];
        return $this->render('list.tpl',['data'=>$data,'page'=>$page,'post'=>$post]);

    }
    public function actionInfo()
    {

        $id=gets('id');
        $data=BanqueDo::BanqueInfo($id);
        $fileter=BanqueDo::UserOrderInfo($id);
        $rows=$fileter['data'];
//        var_dump($rows);die();
        $page=$fileter['page'];
        if(empty($rows))
        {
            $data['is']=0;
        }
        else
            {
                $data['is']=1;
            }
//        var_dump($fileter);die();
        return $this->render('info.tpl',['data'=>$data,'page'=>$page,'rows'=>$rows]);
    }

}